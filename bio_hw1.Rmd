---
title: "Biostat Method_HW 1"
author: "Mengyuan Li"
date: "9/16/2019"

---


```{r}
library(tidyverse)
install.packages('arsenal')
library(arsenal)
```


# problem 1-part a
```{r}
names(Exercise_1) = c("Group","Age","Gender","Race","HTN","T2DM","Depression", "Smokes","systolic_PRE","systolic_POST","diastolic_PRE","diastolic_POST",	"BMI_PRE","BMI_POST", "HDL_PRE","HDL_POST","LDL_PRE","LDL_POST","Glu_PRE","Glu_POST")
my_controls = tableby.control(
               total = F,
               test=F,  # No test p-values yet
               cat.simplify = T,
               numeric.stats = c("meansd", "medianq1q3"),
               cat.stats = c("countpct"),
               stats.labels = list(
               meansd = "Mean (SD)",
               medianq1q3 = "Median (Q1, Q3)",
               countpct = "N (%)"))    
smokes_df = Exercise_1 %>%
          mutate(Smokes=factor(Smokes, labels=c("No","Yes")),
                 Gender=(factor(Gender, labels=c("Male","Female"))), 
                 Depression=factor(Depression, labels=c("No","Yes")),
                 T2DM=factor(T2DM, labels=c("No","Yes")),
                 HTN=factor(HTN, labels=c("No","Yes")),
                 Group=factor(Group, labels=c("control","intervention")),
                 Race=factor(Race,
                             levels=c(1,2,3,4,5,6),
                             labels=c("African American", "Hispanic", "African American", "Caucasian", "Other", "Other")))

my_labels = list(Gender= "Gender(Female)",  HTN= "HTN(Yes)", T2DM = "T2DM(Yes)")

                 


table1 = tableby(Group~Age + Gender + Race + Depression + T2DM + HTN + Smokes , data = smokes_df, control=my_controls)
summary(table1, title = "Demographics and co-morbidities", labelTranslations = my_labels, text=T)

```

# problem 1-part b
```{
# find mean

d0bmi_df = mean(X0$BMI_POST - X0$BMI_PRE)  
s0bmi_df = sd(X0$BMI_POST - X0$BMI_PRE)
d1bmi_df = mean(X1$BMI_POST - X1$BMI_PRE)
s1bmi_df = sd(X1$BMI_POST - X1$BMI_PRE)


d0hdl_df = mean(X0$HDL_POST - X0$HDL_PRE)
s0hdl_df = sd(X0$HDL_POST - X0$HDL_PRE)
d1hdl_df = mean(X1$HDL_POST - X1$HDL_PRE)
s1hdl_df = sd(X1$HDL_POST - X1$HDL_PRE)

d0ldl_df = mean(X0$LDL_POST - X0$LDL_PRE)
d1ldl_df = mean(X1$LDL_POST - X1$LDL_PRE)
s0ldl_df = sd(X0$LDL_POST - X0$LDL_PRE)
s1ldl_df = sd(X1$LDL_POST - X1$LDL_PRE)

d0glu_df = mean(X0$Glu_POST - X0$Glu_PRE)
d1glu_df = mean(X1$Glu_POST - X1$Glu_PRE)
s0glu_df = sd(X0$Glu_POST - X0$Glu_PRE)
s1glu_df = sd(X1$Glu_POST - X1$Glu_PRE)


d0sys_df = mean(X0$systolic_POST - X0$diastolic_PRE)
d1sys_df = mean(X1$systolic_POST - X1$diastolic_PRE)
s0sys_df = sd(X0$systolic_POST - X0$diastolic_PRE)
s1sys_df = sd(X1$systolic_POST - X1$diastolic_PRE)

d0dia_df = mean(X0$diastolic_POST - X0$diastolic_PRE)
d1dia_df = mean(X1$diastolic_POST - X1$diastolic_PRE)
s0dia_df = sd(X0$diastolic_POST - X0$diastolic_PRE)
s1dia_df = sd(X1$diastolic_POST - X1$diastolic_PRE)
```


# problem 1-part ii)
```{r}
ag = aggregate(Exercise_1, 
               by = list(Exercise_1$BMI_POST, Exercise_1$BMI_PRE, Exercise_1$Group), 
               FUN = mean
)
```


```{r}

ta1 = tibble(
        BMI = Exercise_1$BMI_PRE,
        LDL = Exercise_1$LDL_PRE,
        group = Exercise_1$Group,
        index = rep(0,72)
        
)

ta2 = tibble(
        BMI= Exercise_1$BMI_POST,
        LDL = Exercise_1$LDL_POST,
        group = Exercise_1$Group,
        index = rep(1, 72)
)

ta = rbind(ta1, ta2)

ta_df = ta %>%
          mutate(group=factor(group, labels=c("Control","Intervention")),
                 index=factor(index, labels=c('Pre', 'Post')))

plot1 = ggplot(aes(y = BMI, x = group, fill = index), data = ta_df) + geom_boxplot()

plot2 = ggplot(aes(y = LDL, x = group, fill = index), data = ta_df) + geom_boxplot()





```

iii) Discussion: The study plan is organized. It includes many factors that might influence BMI,HDL, Glucose, and other diseases. For example, the plan considers smoking, age, race, depression, etc, as potential factors. However, there are some potential issues that might influence the validity of result. Take the factor depression as an example. Sometimes, it is hard for patients to decide if they have depression or not. Some people have temporary depression because they meet some bad things recently.  
